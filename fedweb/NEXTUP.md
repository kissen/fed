Unify contexts

Think about what we want for the first POC. Only once we have the POC
working should we think about refactoring.
